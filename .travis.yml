sudo: required
dist: trusty
services:
  - mongodb

language: python

python:
  - 3.5
  - 3.6
  - 'nightly'

addons:
  apt:
    sources:
    - sourceline: 'deb [arch=amd64] http://repo.mongodb.org/apt/ubuntu trusty/mongodb-org/3.4 multiverse'
      key_url: 'https://www.mongodb.org/static/pgp/server-3.4.asc'
    packages:
    - mongodb-org-server

os:
  - linux

matrix:
  allow_failures:
    - python: 'nightly'

cache:
  directories:
    - $HOME/.cache/pip

before_cache:
  - rm -f $HOME/.cache/pip/log/debug.log

install:
  - pip install --upgrade pip wheel
  - pip install --upgrade setuptools
  - pip install -r dev-requirements.txt

script:
  - py.test ./tests
